<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <title>DPP Battery Passport ‚Äì Viewer</title>

  <style>
    :root{
      --bg:#0a0f1b;
      --panel:#0f172a;
      --glass: rgba(255,255,255,.06);
      --glass2: rgba(255,255,255,.04);
      --line: rgba(255,255,255,.10);
      --line2: rgba(120,160,255,.16);
      --text:#e9f0ff;
      --muted: rgba(233,240,255,.72);
      --muted2: rgba(233,240,255,.55);
      --blue:#67c7ff;
      --teal:#3fe0c1;
      --shadow: 0 22px 70px rgba(0,0,0,.55);
      --shadow2: 0 14px 44px rgba(0,0,0,.35);
      --r: 22px;
      --r2: 16px;
      --pad: 18px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f3f6ff;
        --panel:#ffffff;
        --glass: rgba(17,24,39,.04);
        --glass2: rgba(17,24,39,.03);
        --line: rgba(17,24,39,.10);
        --line2: rgba(30,64,175,.14);
        --text:#0c1428;
        --muted: rgba(12,20,40,.70);
        --muted2: rgba(12,20,40,.55);
        --shadow: 0 26px 70px rgba(15, 23, 42, .16);
        --shadow2: 0 16px 44px rgba(15, 23, 42, .10);
      }
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: var(--font);
      color: var(--text);
      background:
        radial-gradient(1000px 600px at 15% -10%, rgba(103,199,255,.22), transparent 60%),
        radial-gradient(900px 560px at 100% 0%, rgba(63,224,193,.14), transparent 58%),
        radial-gradient(900px 600px at 10% 110%, rgba(103,199,255,.10), transparent 58%),
        var(--bg);
    }
    a{ color: var(--blue); text-decoration: none; }
    a:hover{ text-decoration: underline; }

    .wrap{ max-width: 1180px; margin: 0 auto; padding: 24px 16px 56px; }

    /* Outer shell like the screenshot */
    .shell{
      border: 1px solid var(--line);
      border-radius: 26px;
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03) 35%, rgba(255,255,255,.02));
      box-shadow: var(--shadow);
      overflow: hidden;
      position: relative;
    }
    .shell::before{
      content:"";
      position:absolute; inset:-1px;
      background: radial-gradient(900px 360px at 20% 0%, rgba(103,199,255,.18), transparent 60%),
                  radial-gradient(600px 320px at 90% 10%, rgba(63,224,193,.14), transparent 55%);
      pointer-events:none;
      opacity:.9;
    }
    .shell > *{ position: relative; }

    .header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 14px;
      padding: 18px 18px;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(0,0,0,.18), transparent);
      backdrop-filter: blur(10px);
    }
    .brand{
      display:flex; align-items:center; gap: 12px;
      min-width: 260px;
    }
    .avatar{
      width: 34px; height: 34px; border-radius: 12px;
      border: 1px solid var(--line);
      background:
        conic-gradient(from 45deg, rgba(255,255,255,.12), rgba(255,255,255,.02), rgba(255,255,255,.12));
      position: relative;
      overflow:hidden;
    }
    .avatar::after{
      content:"";
      position:absolute; inset:0;
      background-image:
        linear-gradient(90deg, rgba(255,255,255,.18) 0 50%, rgba(255,255,255,.03) 50% 100%),
        linear-gradient(0deg, rgba(255,255,255,.18) 0 50%, rgba(255,255,255,.03) 50% 100%);
      background-size: 10px 10px;
      opacity:.55;
      mix-blend-mode: overlay;
    }
    .title{
      font-weight: 700;
      letter-spacing:.2px;
      font-size: 18px;
      margin:0;
    }

    .topright{
      display:flex; align-items:center; gap: 10px; flex-wrap:wrap;
    }

    .btn{
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 10px 14px;
      background: rgba(255,255,255,.05);
      color: var(--text);
      cursor:pointer;
      box-shadow: var(--shadow2);
      transition: transform .05s ease, border-color .15s ease, background .15s ease;
      font-size: 14px;
      display:inline-flex; align-items:center; gap: 8px;
      backdrop-filter: blur(10px);
    }
    .btn:hover{ border-color: rgba(103,199,255,.40); background: rgba(255,255,255,.07); }
    .btn:active{ transform: translateY(1px); }
    .btn.primary{
      border-color: rgba(103,199,255,.55);
      background: rgba(103,199,255,.12);
    }

    .subline{
      padding: 14px 18px 0;
      color: var(--muted);
      font-size: 16px;
    }
    .subline b{ color: var(--blue); font-weight: 700; }

    .content{ padding: 16px 18px 18px; }

    /* Cards */
    .grid2{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 14px;
      margin-top: 14px;
    }
    @media (max-width: 920px){
      .grid2{ grid-template-columns: 1fr; }
    }

    .card{
      border: 1px solid var(--line2);
      border-radius: var(--r);
      background:
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03) 45%, rgba(255,255,255,.02)),
        rgba(0,0,0,.10);
      box-shadow: var(--shadow2);
      backdrop-filter: blur(10px);
      overflow: hidden;
    }
    .card .head{
      display:flex; align-items:center; gap: 10px;
      padding: 14px 16px;
      border-bottom: 1px solid var(--line);
      color: var(--text);
      font-weight: 800;
      letter-spacing:.2px;
      font-size: 22px;
    }
    .card .body{
      padding: 14px 16px 16px;
      color: var(--muted);
      font-size: 16px;
      line-height: 1.45;
    }

    /* Overview layout like screenshot: big icon + list */
    .overviewWrap{
      display:grid;
      grid-template-columns: 92px 1fr;
      gap: 16px;
      align-items:center;
    }
    .bigIcon{
      width: 92px; height: 92px;
      border-radius: 18px;
      border: 1px solid var(--line);
      background: rgba(103,199,255,.08);
      display:flex; align-items:center; justify-content:center;
    }
    .list{
      display:flex; flex-direction:column; gap: 10px;
    }
    .item{
      display:flex; align-items:flex-start; gap: 10px;
      color: var(--muted);
    }
    .item b{ color: var(--text); font-weight: 700; }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
    .inlineLink{
      display:inline-flex; align-items:center; gap: 8px;
      word-break: break-word;
    }
    .iconBtn{
      width: 26px; height: 26px;
      border-radius: 10px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      display:inline-flex; align-items:center; justify-content:center;
      cursor:pointer;
    }

    /* Tabs bar */
    .tabsShell{
      margin-top: 14px;
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(0,0,0,.12);
      box-shadow: var(--shadow2);
      overflow:hidden;
      backdrop-filter: blur(10px);
    }
    .tabs{
      display:flex;
      gap: 0;
      align-items:center;
      padding: 10px 10px;
      border-bottom: 1px solid var(--line);
    }
    .tab{
      padding: 12px 18px;
      color: var(--muted2);
      font-size: 18px;
      cursor:pointer;
      border-radius: 12px;
      position: relative;
      user-select:none;
    }
    .tab.active{
      color: var(--blue);
      font-weight: 800;
    }
    .tab.active::after{
      content:"";
      position:absolute;
      left: 14px; right: 14px; bottom: -10px;
      height: 3px;
      border-radius: 999px;
      background: linear-gradient(90deg, rgba(103,199,255,.0), rgba(103,199,255,.9), rgba(103,199,255,.0));
    }

    .tabsBody{
      padding: 14px 14px 16px;
    }

    .cols2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    @media (max-width: 920px){
      .cols2{ grid-template-columns: 1fr; }
    }

    .miniCard{
      border: 1px solid var(--line2);
      border-radius: var(--r);
      background: rgba(255,255,255,.03);
      box-shadow: var(--shadow2);
      overflow:hidden;
      backdrop-filter: blur(10px);
    }
    .miniHead{
      padding: 14px 16px;
      border-bottom: 1px solid var(--line);
      display:flex; align-items:center; gap: 10px;
      font-weight: 900;
      font-size: 22px;
    }
    .miniBody{
      padding: 14px 16px 16px;
      color: var(--muted);
      font-size: 16px;
      line-height: 1.45;
    }
    .kv{
      display:grid;
      grid-template-columns: 210px 1fr;
      gap: 10px 14px;
    }
    @media (max-width: 720px){
      .kv{ grid-template-columns: 1fr; }
    }
    .k{ color: var(--muted2); }
    .v{ color: var(--text); }

    .hint{
      margin-top: 10px;
      font-size: 13px;
      color: var(--muted2);
    }

    /* clean mode for thesis screenshots */
    .clean .header,
    .clean .subline,
    .clean .helperBar{ display:none !important; }
    .helperBar{
      padding: 10px 18px 0;
      color: var(--muted2);
      font-size: 13px;
    }

    /* Simple SVG icons */
    .svg{ width: 26px; height: 26px; opacity: .95; }
    .svgSmall{ width: 18px; height: 18px; opacity: .95; }

    @media print{
      body{ background:#fff !important; }
      .shell{ box-shadow:none !important; }
      .header, .subline, .helperBar{ display:none !important; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="shell">
      <div class="header">
        <div class="brand">
          <div class="avatar" aria-hidden="true"></div>
          <div class="title">DPP Battery Passport ‚Äì Viewer</div>
        </div>

        <div class="topright">
          <button class="btn" id="copyLink">
            <span>Link kopyala</span>
          </button>
          <button class="btn primary" id="goProfessional">
            <span>Professional Access</span>
          </button>
        </div>
      </div>

      <div class="subline">
        QR ile eri≈üilen pasaport i√ßeriƒüi, <b>Public / Professional / Authority</b> g√∂r√ºn√ºmleriyle g√∂sterilir.
      </div>

      <div class="helperBar">
        Tez ekran g√∂r√ºnt√ºs√º i√ßin: URL sonuna <span class="mono">mode=clean</span> ekleyebilirsin.
      </div>

      <div class="content" id="app"></div>
    </div>
  </div>

<script>
  // ---------------------------------------------------------
  // DATA (Demo) ‚Äî burayƒ± senin i√ßeriƒüine g√∂re b√ºy√ºt√ºr√ºz
  // ---------------------------------------------------------
  const DB = {
    "urn:iso:15459:DPPBAT.CN.EV.2026.000001": {
      overview: {
        uid: "urn:iso:15459:DPPBAT.CN.EV.2026.000001",
        category: "EV traction battery",
        manufacturer: "Shenzhen PowerCell Ltd. (CN)",
        site: "Shenzhen, Guangdong (CN)",
        production: "December 2026"
      },
      safety: {
        hazardous: "Declared (demo)\nCobalt, Nickel as REACH ‚â• 0.1%",
        extinguishing: "Water mist, D, BC powder"
      },
      sustainability: {
        carbon: "58.0 kgCO‚ÇÇe / kWh",
        method: "EN 50693_REACH: Methodology details (demo)",
        recycled: "Cobalt: 6 %, Ni 5 %, Li 2 %",
        recycled_note: "Shenzhen 2026, Co/Ni/Li production (demo)"
      },
      sourcing: {
        dd: "D3R Directive ‚Äî Shenzhen PowerCell Ltd. (demo)",
        epr: "EPR Directive ‚Äî National (TR) collection guidelines (demo)"
      },
      documents: [
        { title: "EU Declaration of Conformity (demo)", url: "https://example.com/eu-doc-demo" },
        { title: "Carbon footprint study (demo)", url: "https://example.com/pcf-demo" }
      ],
      professional: {
        note: "Bu alanlar ger√ßek hayatta yetkilendirme ile a√ßƒ±lƒ±r (demo).",
        dismantling: "HV isolation + PPE required. Disassembly sequence: (demo link)."
      },
      authority: {
        note: "Yetkili kurum/NB g√∂r√ºn√ºm√º (demo).",
        reports: ["TR-CN-EV-2026-EMC-01 (demo)"],
        soh: "SoH 98.4%, cycles 62"
      }
    },

    "urn:iso:15459:DPPBAT.EU.EV.2026.000001": {
      overview: {
        uid: "urn:iso:15459:DPPBAT.EU.EV.2026.000001",
        category: "EV traction battery",
        manufacturer: "EuroCell Energy S.A. (EU)",
        site: "Wroclaw (PL)",
        production: "December 2026"
      },
      safety: {
        hazardous: "Declared (demo)\nNickel as REACH ‚â• 0.1%",
        extinguishing: "Water mist, D, BC powder"
      },
      sustainability: {
        carbon: "41.5 kgCO‚ÇÇe / kWh",
        method: "EN 50693_REACH: Methodology details (demo)",
        recycled: "Cobalt: 10 %, Ni 8 %, Li 4 %",
        recycled_note: "Wroclaw 2026, Co/Ni/Li production (demo)"
      },
      sourcing: {
        dd: "D3R Directive ‚Äî EuroCell Energy S.A. (demo)",
        epr: "EPR Directive ‚Äî National (TR) collection guidelines (demo)"
      },
      documents: [
        { title: "EU Declaration of Conformity (demo)", url: "https://example.com/eu-doc-demo" },
        { title: "Carbon footprint study (demo)", url: "https://example.com/pcf-demo" }
      ],
      professional: {
        note: "Bu alanlar ger√ßek hayatta yetkilendirme ile a√ßƒ±lƒ±r (demo).",
        dismantling: "HV isolation + thermal-runaway precautions (demo)."
      },
      authority: {
        note: "Yetkili kurum/NB g√∂r√ºn√ºm√º (demo).",
        reports: ["TR-EU-EV-2026-EMC-01 (demo)"],
        soh: "SoH 99.1%, cycles 58"
      }
    }
  };

  // ---------------------------------------------------------
  // URL params
  // ---------------------------------------------------------
  const qs = new URLSearchParams(location.search);
  const uid = qs.get("uid") || Object.keys(DB)[0];
  const role = (qs.get("role") || "public").toLowerCase();     // public | professional | authority
  const tab  = (qs.get("tab")  || "details").toLowerCase();    // details | sustainability | circularity | documents | professional

  if(qs.get("mode")==="clean") document.body.classList.add("clean");

  function baseUrl(){
    return location.origin + location.pathname;
  }
  function linkFor(next = {}){
    const p = new URLSearchParams(location.search);
    for(const [k,v] of Object.entries(next)){
      if(v === null) p.delete(k);
      else p.set(k, v);
    }
    return `${baseUrl()}?${p.toString()}`;
  }
  async function copy(text){
    try{ await navigator.clipboard.writeText(text); alert("Kopyalandƒ±"); }
    catch{ prompt("Kopyalamak i√ßin:", text); }
  }

  // ---------------------------------------------------------
  // SVG icons (inline)
  // ---------------------------------------------------------
  const ICONS = {
    clip: `<svg class="svgSmall" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M21.44 11.05l-9.19 9.19a5 5 0 0 1-7.07-7.07l9.9-9.9a3.5 3.5 0 0 1 4.95 4.95l-10.6 10.6a2 2 0 1 1-2.83-2.83l9.9-9.9"/>
    </svg>`,
    doc: `<svg class="svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
      <path d="M14 2v6h6"/>
      <path d="M16 13H8"/><path d="M16 17H8"/><path d="M10 9H8"/>
    </svg>`,
    shield:`<svg class="svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
      <path d="M9 12l2 2 4-4"/>
    </svg>`,
    battery:`<svg class="svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <rect x="2" y="7" width="18" height="10" rx="2"/>
      <path d="M22 11v2"/>
      <path d="M6 10h8"/><path d="M6 14h6"/>
    </svg>`,
    leaf:`<svg class="svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M11 20c6 0 10-4 10-10V4s-6 0-10 4-4 10-4 10 1 2 4 2z"/>
      <path d="M21 4L11 14"/>
    </svg>`,
    recycle:`<svg class="svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M7 19l-2-3 3-2"/><path d="M3 16h6"/><path d="M7 5l2 3-3 2"/><path d="M9 8H3"/>
      <path d="M17 19l-2 3-3-2"/><path d="M21 16h-6"/><path d="M17 5l2-3 3 2"/><path d="M15 8h6"/>
    </svg>`,
    user:`<svg class="svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M20 21a8 8 0 0 0-16 0"/><circle cx="12" cy="7" r="4"/>
    </svg>`
  };

  // ---------------------------------------------------------
  // Render
  // ---------------------------------------------------------
  const data = DB[uid];
  const app = document.getElementById("app");

  function tabBtn(name, key){
    const active = (tab === key) ? "active" : "";
    return `<div class="tab ${active}" data-tab="${key}">${name}</div>`;
  }

  function renderNotFound(){
    app.innerHTML = `
      <div class="card">
        <div class="head">${ICONS.doc} Passport Not Found</div>
        <div class="body">
          Bu UID i√ßin kayƒ±t yok: <span class="mono">${uid}</span>
        </div>
      </div>
    `;
  }

  function render(){
    if(!data){ renderNotFound(); return; }

    // top cards (overview + safety)
    const overview = `
      <div class="card">
        <div class="head">${ICONS.doc} Battery Passport Overview</div>
        <div class="body">
          <div class="overviewWrap">
            <div class="bigIcon" aria-hidden="true">${ICONS.battery}</div>
            <div class="list">
              <div class="item">
                <span class="k">UID:</span>
                <span class="v inlineLink"><b class="mono">${data.overview.uid}</b>
                  <span class="iconBtn" id="copyUid" title="UID kopyala">${ICONS.clip}</span>
                </span>
              </div>
              <div class="item"><span class="k">üåê</span><span class="v">${data.overview.category}</span></div>
              <div class="item"><span class="k">üè¢</span><span class="v">${data.overview.manufacturer}</span></div>
              <div class="item"><span class="k">üè≠</span><span class="v">Manufacturing site: ${data.overview.site}</span></div>
              <div class="item"><span class="k">üóìÔ∏è</span><span class="v">Production date: ${data.overview.production}</span></div>
            </div>
          </div>
        </div>
      </div>
    `;

    const safety = `
      <div class="card">
        <div class="head">${ICONS.shield} Safety Snapshot</div>
        <div class="body">
          <div style="font-weight:800; color:var(--text); margin-bottom:6px;">Hazardous substances</div>
          <div style="white-space:pre-line;">${data.safety.hazardous}</div>

          <div style="height:14px"></div>

          <div style="font-weight:800; color:var(--text); margin-bottom:6px;">Extinguishing agent</div>
          <div style="color:var(--teal); font-weight:700;">‚ôª ${data.safety.extinguishing}</div>
        </div>
      </div>
    `;

    // tabs + body
    const tabs = `
      <div class="tabsShell">
        <div class="tabs" id="tabs">
          ${tabBtn("Details","details")}
          ${tabBtn("Sustainability","sustainability")}
          ${tabBtn("Circularity","circularity")}
          ${tabBtn("Documents","documents")}
          ${tabBtn("Professional Access","professional")}
        </div>
        <div class="tabsBody" id="tabBody"></div>
      </div>
    `;

    app.innerHTML = `
      <div class="grid2">${overview}${safety}</div>
      ${tabs}
    `;

    // Tab bodies
    const tabBody = document.getElementById("tabBody");

    function showDetails(){
      tabBody.innerHTML = `
        <div class="cols2">
          <div class="miniCard">
            <div class="miniHead">${ICONS.battery} Details</div>
            <div class="miniBody">
              <div class="kv">
                <div class="k">Current role</div>
                <div class="v"><b>${role.toUpperCase()}</b></div>
                <div class="k">Shareable link</div>
                <div class="v"><a href="${linkFor({uid, role, tab:"details"})}">${linkFor({uid, role, tab:"details"})}</a></div>
              </div>
              <div class="hint">QR ile a√ßƒ±lan sayfa varsayƒ±lan olarak Public i√ßerik sunar.</div>
            </div>
          </div>

          <div class="miniCard">
            <div class="miniHead">${ICONS.user} Demo se√ßim</div>
            <div class="miniBody">
              <div class="kv">
                <div class="k">Kayƒ±t</div>
                <div class="v">
                  <select id="pick" style="width:100%; padding:10px 12px; border-radius:14px; border:1px solid var(--line); background:rgba(255,255,255,.04); color:var(--text);">
                    ${Object.keys(DB).map(k=>`<option value="${k}" ${k===uid?'selected':''}>${k.includes(".CN.")?"China (CN)":"EU (EU)"} ‚Äî ${k}</option>`).join("")}
                  </select>
                </div>
              </div>
              <div class="hint">Kayƒ±t deƒüi≈ütirince URL g√ºncellenir (QR senaryosu i√ßin).</div>
            </div>
          </div>
        </div>
      `;

      document.getElementById("pick").addEventListener("change",(e)=>{
        location.href = linkFor({ uid: e.target.value, tab:"details" });
      });
    }

    function showSustainability(){
      tabBody.innerHTML = `
        <div class="cols2">
          <div class="miniCard">
            <div class="miniHead">${ICONS.leaf} Sustainability Snapshot</div>
            <div class="miniBody">
              <div style="font-weight:800; color:var(--text)">Battery carbon footprint</div>
              <div style="margin-top:6px;"><b style="color:var(--blue)">${data.sustainability.carbon}</b></div>
              <div class="hint">${data.sustainability.method}</div>

              <div style="height:14px"></div>

              <div style="font-weight:800; color:var(--text)">Recycled content</div>
              <div style="margin-top:6px;">${data.sustainability.recycled}</div>
              <div class="hint">${data.sustainability.recycled_note}</div>
            </div>
          </div>

          <div class="miniCard">
            <div class="miniHead">${ICONS.recycle} Responsible Sourcing</div>
            <div class="miniBody">
              <div style="display:flex; gap:10px; align-items:flex-start; margin-bottom:12px;">
                <div style="opacity:.9">üß™</div>
                <div>
                  <div style="font-weight:800; color:var(--text)">D3R Directive</div>
                  <div class="hint">${data.sourcing.dd}</div>
                </div>
              </div>

              <div style="display:flex; gap:10px; align-items:flex-start;">
                <div style="opacity:.9">üåÄ</div>
                <div>
                  <div style="font-weight:800; color:var(--text)">EPR Directive</div>
                  <div class="hint">${data.sourcing.epr}</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function showCircularity(){
      tabBody.innerHTML = `
        <div class="miniCard">
          <div class="miniHead">${ICONS.recycle} Circularity</div>
          <div class="miniBody">
            <div class="kv">
              <div class="k">Collection / Take-back</div>
              <div class="v">Ulusal toplama sistemi ve geri d√∂n√º≈ü√ºm y√∂nlendirmesi (demo).</div>
              <div class="k">Disassembly</div>
              <div class="v">Detay s√∂k√ºm talimatlarƒ± <b>Professional</b> eri≈üim ile a√ßƒ±lƒ±r.</div>
              <div class="k">Repair / Reuse</div>
              <div class="v">Second-life / repurposing senaryolarƒ± i√ßin SoH verileri yetkili rollerde g√∂sterilir (demo).</div>
            </div>
          </div>
        </div>
      `;
    }

    function showDocuments(){
      const list = (data.documents||[]).map(d=>`<li><a href="${d.url}" target="_blank" rel="noopener">${d.title}</a></li>`).join("");
      tabBody.innerHTML = `
        <div class="miniCard">
          <div class="miniHead">${ICONS.doc} Documents</div>
          <div class="miniBody">
            <ul style="margin:0; padding-left:18px;">${list || "<li>No documents (demo)</li>"}</ul>
          </div>
        </div>
      `;
    }

    function showProfessional(){
      const locked = (role !== "professional" && role !== "authority");
      tabBody.innerHTML = `
        <div class="miniCard">
          <div class="miniHead">${ICONS.user} Professional Access</div>
          <div class="miniBody">
            <div class="kv">
              <div class="k">Access status</div>
              <div class="v"><b>${locked ? "Locked (demo)" : "Enabled (demo)"}</b></div>
              <div class="k">Note</div>
              <div class="v">${data.professional.note}</div>
              <div class="k">Dismantling</div>
              <div class="v">${locked ? "üîí Yetkilendirme gerekir (demo)." : data.professional.dismantling}</div>
              <div class="k">Authority info</div>
              <div class="v">${role==="authority" ? `${data.authority.note}<br/>Reports: ${data.authority.reports.join(", ")}<br/>${data.authority.soh}` : "‚Äî"}</div>
            </div>
            <div style="height:14px"></div>
            <button class="btn primary" id="unlockPro">Professional role‚Äôa ge√ß (demo)</button>
            <button class="btn" id="unlockAuth">Authority role‚Äôa ge√ß (demo)</button>
          </div>
        </div>
      `;

      document.getElementById("unlockPro").onclick  = ()=> location.href = linkFor({ role:"professional", tab:"professional" });
      document.getElementById("unlockAuth").onclick = ()=> location.href = linkFor({ role:"authority", tab:"professional" });
    }

    // switch by tab
    const map = {
      details: showDetails,
      sustainability: showSustainability,
      circularity: showCircularity,
      documents: showDocuments,
      professional: showProfessional
    };
    (map[tab] || showDetails)();

    // wire tabs
    document.getElementById("tabs").addEventListener("click",(e)=>{
      const t = e.target.closest(".tab");
      if(!t) return;
      location.href = linkFor({ tab: t.dataset.tab });
    });

    // copy UID
    const copyUid = document.getElementById("copyUid");
    if(copyUid){
      copyUid.onclick = ()=> copy(data.overview.uid);
    }
  }

  render();

  // header buttons
  document.getElementById("copyLink").onclick = ()=> copy(location.href);
  document.getElementById("goProfessional").onclick = ()=> location.href = linkFor({ tab:"professional", role:"professional" });
</script>
</body>
</html>

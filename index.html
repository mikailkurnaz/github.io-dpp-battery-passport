<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="dark light" />
  <title>DPP-Battery Passport</title>

  <style>
    :root{
      --bg:#0a0f1b;
      --glass: rgba(255,255,255,.06);
      --line: rgba(255,255,255,.10);
      --line2: rgba(120,160,255,.16);
      --text:#e9f0ff;
      --muted: rgba(233,240,255,.72);
      --muted2: rgba(233,240,255,.55);
      --blue:#67c7ff;
      --teal:#3fe0c1;
      --shadow: 0 22px 70px rgba(0,0,0,.55);
      --shadow2: 0 14px 44px rgba(0,0,0,.35);
      --r: 22px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f3f6ff;
        --glass: rgba(17,24,39,.04);
        --line: rgba(17,24,39,.10);
        --line2: rgba(30,64,175,.14);
        --text:#0c1428;
        --muted: rgba(12,20,40,.70);
        --muted2: rgba(12,20,40,.55);
        --shadow: 0 26px 70px rgba(15, 23, 42, .16);
        --shadow2: 0 16px 44px rgba(15, 23, 42, .10);
      }
    }

    *{ box-sizing:border-box; }
    html, body { height:100%; }
    body{
      margin:0;
      font-family: var(--font);
      color: var(--text);
      background:
        radial-gradient(1000px 600px at 15% -10%, rgba(103,199,255,.22), transparent 60%),
        radial-gradient(900px 560px at 100% 0%, rgba(63,224,193,.14), transparent 58%),
        radial-gradient(900px 600px at 10% 110%, rgba(103,199,255,.10), transparent 58%),
        var(--bg);
      overflow-x:hidden;
    }
    a{ color: var(--blue); text-decoration: none; }
    a:hover{ text-decoration: underline; }

    .wrap{
      max-width: 1180px;
      margin: 0 auto;
      padding: 20px 14px 52px;
      padding-bottom: calc(52px + env(safe-area-inset-bottom, 0px));
    }

    .shell{
      border: 1px solid var(--line);
      border-radius: 26px;
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03) 35%, rgba(255,255,255,.02));
      box-shadow: var(--shadow);
      overflow: hidden;
      position: relative;
    }
    .shell::before{
      content:"";
      position:absolute; inset:-1px;
      background: radial-gradient(900px 360px at 20% 0%, rgba(103,199,255,.18), transparent 60%),
                  radial-gradient(600px 320px at 90% 10%, rgba(63,224,193,.14), transparent 55%);
      pointer-events:none;
      opacity:.9;
    }
    .shell > *{ position: relative; }

    /* Header */
    .header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      padding: 16px 16px;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(0,0,0,.18), transparent);
      backdrop-filter: blur(10px);
    }
    .brand{
      display:flex; align-items:center; gap: 12px;
      min-width: 220px;
    }
    .avatar{
      width: 34px; height: 34px; border-radius: 12px;
      border: 1px solid var(--line);
      background: conic-gradient(from 45deg, rgba(255,255,255,.12), rgba(255,255,255,.02), rgba(255,255,255,.12));
      position: relative;
      overflow:hidden;
      flex: 0 0 auto;
    }
    .avatar::after{
      content:"";
      position:absolute; inset:0;
      background-image:
        linear-gradient(90deg, rgba(255,255,255,.18) 0 50%, rgba(255,255,255,.03) 50% 100%),
        linear-gradient(0deg, rgba(255,255,255,.18) 0 50%, rgba(255,255,255,.03) 50% 100%);
      background-size: 10px 10px;
      opacity:.55;
      mix-blend-mode: overlay;
    }

    .title{
      font-weight: 950;
      letter-spacing:.2px;
      margin:0;
      font-size: clamp(15px, 2.2vw, 18px);
      line-height: 1.2;
      white-space: nowrap;
    }

    .topright{
      display:flex; align-items:center; gap: 10px; flex-wrap:wrap;
      justify-content:flex-end;
    }

    .btn{
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 10px 12px;
      background: rgba(255,255,255,.05);
      color: var(--text);
      cursor:pointer;
      box-shadow: var(--shadow2);
      transition: transform .05s ease, border-color .15s ease, background .15s ease;
      font-size: 14px;
      display:inline-flex; align-items:center; gap: 8px;
      backdrop-filter: blur(10px);
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
      user-select:none;
      white-space: nowrap;
    }
    .btn:hover{ border-color: rgba(103,199,255,.40); background: rgba(255,255,255,.07); }
    .btn:active{ transform: translateY(1px); }
    .btn.primary{
      border-color: rgba(103,199,255,.55);
      background: rgba(103,199,255,.12);
    }

    .subline{
      padding: 12px 16px 0;
      color: var(--muted);
      font-size: clamp(14px, 2vw, 16px);
    }

    .content{ padding: 14px 16px 16px; }

    /* Cards */
    .grid2{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap: 14px;
      margin-top: 12px;
    }

    .card{
      border: 1px solid var(--line2);
      border-radius: var(--r);
      background:
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03) 45%, rgba(255,255,255,.02)),
        rgba(0,0,0,.10);
      box-shadow: var(--shadow2);
      backdrop-filter: blur(10px);
      overflow: hidden;
    }
    .card .head{
      display:flex; align-items:center; gap: 10px;
      padding: 12px 14px;
      border-bottom: 1px solid var(--line);
      font-weight: 950;
      letter-spacing:.2px;
      font-size: clamp(16px, 2.6vw, 22px);
    }
    .card .body{
      padding: 12px 14px 14px;
      color: var(--muted);
      font-size: clamp(14px, 2vw, 16px);
      line-height: 1.45;
    }

    /* Overview layout */
    .overviewWrap{
      display:grid;
      grid-template-columns: 92px 1fr;
      gap: 14px;
      align-items:center;
    }
    .bigIcon{
      width: 92px; height: 92px;
      border-radius: 18px;
      border: 1px solid var(--line);
      background: rgba(103,199,255,.08);
      display:flex; align-items:center; justify-content:center;
    }
    .list{ display:flex; flex-direction:column; gap: 10px; }
    .item{ display:flex; align-items:flex-start; gap: 10px; color: var(--muted); }
    .item b{ color: var(--text); font-weight: 900; }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
    .inlineLink{ display:flex; align-items:center; gap: 8px; flex-wrap:wrap; word-break: break-word; }
    .iconBtn{
      width: 28px; height: 28px;
      border-radius: 10px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      display:inline-flex; align-items:center; justify-content:center;
      cursor:pointer;
      flex: 0 0 auto;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
    }

    /* Tabs */
    .tabsShell{
      margin-top: 14px;
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(0,0,0,.12);
      box-shadow: var(--shadow2);
      overflow:hidden;
      backdrop-filter: blur(10px);
    }
    .tabs{
      display:flex;
      gap: 10px;
      align-items:center;
      padding: 10px 10px;
      border-bottom: 1px solid var(--line);
      overflow-x:auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      background: rgba(0,0,0,.06);
    }
    .tabs::-webkit-scrollbar{ display:none; }

    .tab{
      padding: 12px 16px;
      color: var(--muted2);
      font-size: clamp(14px, 2.2vw, 18px);
      cursor:pointer;
      border-radius: 12px;
      user-select:none;
      white-space: nowrap;
      flex: 0 0 auto;
      border: 1px solid transparent;
    }
    .tab.active{
      color: var(--blue);
      font-weight: 950;
      background: rgba(103,199,255,.10);
      border-color: rgba(103,199,255,.22);
    }

    .tabsBody{ padding: 14px 14px 16px; }

    .cols2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    .miniCard{
      border: 1px solid var(--line2);
      border-radius: var(--r);
      background: rgba(255,255,255,.03);
      box-shadow: var(--shadow2);
      overflow:hidden;
      backdrop-filter: blur(10px);
    }
    .miniHead{
      padding: 12px 14px;
      border-bottom: 1px solid var(--line);
      display:flex; align-items:center; gap: 10px;
      font-weight: 950;
      font-size: clamp(16px, 2.6vw, 22px);
    }
    .miniBody{
      padding: 12px 14px 14px;
      color: var(--muted);
      font-size: clamp(14px, 2vw, 16px);
      line-height: 1.45;
    }

    .kv{
      display:grid;
      grid-template-columns: 200px 1fr;
      gap: 10px 14px;
      align-items:start;
    }
    .k{ color: var(--muted2); }
    .v{ color: var(--text); word-break: break-word; }

    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding: 6px 10px;
      border:1px solid var(--line);
      border-radius: 999px;
      background: rgba(255,255,255,.04);
      color: var(--text);
      font-size: 13px;
      font-weight: 800;
      width: fit-content;
    }
    .dot{
      width:8px; height:8px; border-radius:999px;
      background: var(--blue);
      box-shadow: 0 0 18px rgba(103,199,255,.35);
    }

    /* Toast */
    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      background: rgba(0,0,0,.75);
      color: #fff;
      border: 1px solid rgba(255,255,255,.18);
      border-radius: 999px;
      padding: 10px 14px;
      font-size: 13px;
      box-shadow: 0 18px 50px rgba(0,0,0,.45);
      backdrop-filter: blur(10px);
      opacity: 0;
      pointer-events: none;
      transition: opacity .18s ease, transform .18s ease;
    }
    .toast.show{
      opacity: 1;
      transform: translateX(-50%) translateY(-6px);
    }

    /* === MOBILE BREAKPOINTS === */
    @media (max-width: 920px){
      .grid2{ grid-template-columns: 1fr; }
      .cols2{ grid-template-columns: 1fr; }
    }
    @media (max-width: 600px){
      .wrap{ padding: 14px 10px 44px; }
      .header{
        flex-direction: column;
        align-items: stretch;
        gap: 10px;
      }
      .brand{ min-width: 0; }
      .title{ white-space: normal; }
      .topright{ width:100%; justify-content: stretch; }
      .btn{
        width:100%;
        justify-content:center;
        padding: 12px 14px;
      }
      .content{ padding: 12px 12px 14px; }
      .subline{ padding: 10px 12px 0; }
      .overviewWrap{ grid-template-columns: 1fr; }
      .bigIcon{ width: 78px; height: 78px; }
      .kv{ grid-template-columns: 1fr; }
      .tabs{ position: sticky; top: 0; z-index: 5; }
    }

    /* Clean mode for thesis screenshots */
    .clean .header,
    .clean .subline { display:none !important; }

    @media print{
      body{ background:#fff !important; }
      .shell{ box-shadow:none !important; }
      .header, .subline{ display:none !important; }
    }

    .svg{ width: 26px; height: 26px; opacity: .95; }
    .svgSmall{ width: 18px; height: 18px; opacity: .95; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="shell">
      <div class="header">
        <div class="brand">
          <div class="avatar" aria-hidden="true"></div>
          <div class="title">DPP-Battery Passport</div>
        </div>

        <div class="topright">
          <button class="btn" id="copyLink">Link kopyala</button>
          <button class="btn primary" id="goAccess">Access</button>
        </div>
      </div>

      <div class="subline">
        QR kod ile batarya pasaportuna erişim.
      </div>

      <div class="content" id="app"></div>
    </div>
  </div>

  <div class="toast" id="toast">Kopyalandı</div>

<script>
  // ---------------------------------------------------------
  // DATA (örnek içerik; senin tez verilerinle genişletilebilir)
  // ---------------------------------------------------------
  const DB = {
    "urn:iso:15459:DPPBAT.CN.EV.2026.000001": {
      overview: {
        uid: "urn:iso:15459:DPPBAT.CN.EV.2026.000001",
        category: "EV traction battery",
        manufacturer: "Shenzhen PowerCell Ltd. (CN)",
        site: "Shenzhen, Guangdong (CN)",
        production: "December 2026"
      },
      safety: {
        hazardous: "Declared\nCobalt, Nickel as REACH ≥ 0.1%",
        extinguishing: "Water mist, Class D media, BC powder"
      },
      sustainability: {
        carbon: "58.0 kgCO₂e / kWh",
        method: "Methodology reference",
        recycled: "Cobalt: 6 %, Nickel: 5 %, Lithium: 2 %",
        recycled_note: "Production reference"
      },
      sourcing: {
        dd: "Due diligence / sourcing reference",
        epr: "National collection / take-back guidance"
      },
      documents: [
        { title: "EU Declaration of Conformity", url: "https://example.com/eu-doc" },
        { title: "Carbon footprint study", url: "https://example.com/pcf" }
      ],
      professional: {
        dismantling: "HV isolation + PPE required. Disassembly sequence available under restricted access."
      },
      authority: {
        reports: ["Test Report ID: TR-CN-EV-2026-EMC-01"],
        soh: "SoH 98.4% · cycles 62"
      }
    },

    "urn:iso:15459:DPPBAT.EU.EV.2026.000001": {
      overview: {
        uid: "urn:iso:15459:DPPBAT.EU.EV.2026.000001",
        category: "EV traction battery",
        manufacturer: "EuroCell Energy S.A. (EU)",
        site: "Wroclaw (PL)",
        production: "December 2026"
      },
      safety: {
        hazardous: "Declared\nNickel as REACH ≥ 0.1%",
        extinguishing: "Water mist, Class D media, BC powder"
      },
      sustainability: {
        carbon: "41.5 kgCO₂e / kWh",
        method: "Methodology reference",
        recycled: "Cobalt: 10 %, Nickel: 8 %, Lithium: 4 %",
        recycled_note: "Production reference"
      },
      sourcing: {
        dd: "Due diligence / sourcing reference",
        epr: "National collection / take-back guidance"
      },
      documents: [
        { title: "EU Declaration of Conformity", url: "https://example.com/eu-doc" },
        { title: "Carbon footprint study", url: "https://example.com/pcf" }
      ],
      professional: {
        dismantling: "HV isolation + thermal-runaway precautions. Disassembly sequence available under restricted access."
      },
      authority: {
        reports: ["Test Report ID: TR-EU-EV-2026-EMC-01"],
        soh: "SoH 99.1% · cycles 58"
      }
    }
  };

  // ---------------------------------------------------------
  // URL params
  // ---------------------------------------------------------
  const qs = new URLSearchParams(location.search);
  const uid = qs.get("uid") || Object.keys(DB)[0];
  const role = (qs.get("role") || "public").toLowerCase(); // public|professional|authority
  const tab  = (qs.get("tab")  || "details").toLowerCase(); // details|sustainability|circularity|documents|access

  if(qs.get("mode")==="clean") document.body.classList.add("clean");

  function baseUrl(){ return location.origin + location.pathname; }
  function linkFor(next = {}){
    const p = new URLSearchParams(location.search);
    for(const [k,v] of Object.entries(next)){
      if(v === null) p.delete(k);
      else p.set(k, v);
    }
    return `${baseUrl()}?${p.toString()}`;
  }
  function esc(s){
    return String(s).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;");
  }

  const toast = document.getElementById("toast");
  let toastTimer = null;
  function showToast(msg="Kopyalandı"){
    toast.textContent = msg;
    toast.classList.add("show");
    clearTimeout(toastTimer);
    toastTimer = setTimeout(()=> toast.classList.remove("show"), 1400);
  }

  async function copy(text){
    try{
      await navigator.clipboard.writeText(text);
      showToast("Kopyalandı");
    }catch{
      prompt("Kopyalamak için:", text);
    }
  }

  // SVG icons
  const ICONS = {
    doc: `<svg class="svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
      <path d="M14 2v6h6"/><path d="M16 13H8"/><path d="M16 17H8"/><path d="M10 9H8"/>
    </svg>`,
    shield:`<svg class="svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="M9 12l2 2 4-4"/>
    </svg>`,
    battery:`<svg class="svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <rect x="2" y="7" width="18" height="10" rx="2"/><path d="M22 11v2"/><path d="M6 10h8"/><path d="M6 14h6"/>
    </svg>`,
    clip: `<svg class="svgSmall" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M21.44 11.05l-9.19 9.19a5 5 0 0 1-7.07-7.07l9.9-9.9a3.5 3.5 0 0 1 4.95 4.95l-10.6 10.6a2 2 0 1 1-2.83-2.83l9.9-9.9"/>
    </svg>`
  };

  const app = document.getElementById("app");
  const data = DB[uid];

  function tabBtn(name, key){
    return `<div class="tab ${tab===key?'active':''}" data-tab="${key}">${name}</div>`;
  }

  function renderNotFound(){
    app.innerHTML = `
      <div class="card">
        <div class="head">${ICONS.doc} DPP-Battery Passport</div>
        <div class="body">UID için kayıt bulunamadı: <span class="mono">${esc(uid)}</span></div>
      </div>
    `;
  }

  function viewChip(){
    const label = role === "authority" ? "Authority" : (role === "professional" ? "Professional" : "Public");
    return `<span class="chip"><span class="dot"></span>${label}</span>`;
  }

  function showTabBody(tabBody){
    const d = data;

    if(tab === "details"){
      tabBody.innerHTML = `
        <div class="cols2">
          <div class="miniCard">
            <div class="miniHead">${ICONS.battery} Details</div>
            <div class="miniBody">
              ${viewChip()}
              <div style="height:10px"></div>
              <div class="kv">
                <div class="k">Shareable link</div>
                <div class="v"><a href="${esc(linkFor({uid, role, tab:"details"}))}">${esc(linkFor({uid, role, tab:"details"}))}</a></div>
              </div>
            </div>
          </div>

          <div class="miniCard">
            <div class="miniHead">${ICONS.doc} Passport</div>
            <div class="miniBody">
              <div class="kv">
                <div class="k">UID</div>
                <div class="v"><span class="mono">${esc(d.overview.uid)}</span></div>
                <div class="k">Select</div>
                <div class="v">
                  <select id="pick" style="width:100%; padding:12px 12px; border-radius:14px; border:1px solid var(--line); background:rgba(255,255,255,.04); color:var(--text); font-size:14px;">
                    ${Object.keys(DB).map(k=>`<option value="${k}" ${k===uid?'selected':''}>${k.includes(".CN.")?"China (CN)":"EU (EU)"} — ${k}</option>`).join("")}
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
      document.getElementById("pick").addEventListener("change",(e)=>{
        location.href = linkFor({ uid: e.target.value, tab:"details" });
      });
      return;
    }

    if(tab === "sustainability"){
      tabBody.innerHTML = `
        <div class="cols2">
          <div class="miniCard">
            <div class="miniHead">${ICONS.doc} Sustainability</div>
            <div class="miniBody">
              ${viewChip()}
              <div style="height:12px"></div>
              <div class="kv">
                <div class="k">Carbon footprint</div>
                <div class="v"><b style="color:var(--blue)">${esc(d.sustainability.carbon)}</b></div>
                <div class="k">Methodology</div>
                <div class="v">${esc(d.sustainability.method)}</div>
                <div class="k">Recycled content</div>
                <div class="v">${esc(d.sustainability.recycled)}</div>
                <div class="k">Reference</div>
                <div class="v">${esc(d.sustainability.recycled_note)}</div>
              </div>
            </div>
          </div>

          <div class="miniCard">
            <div class="miniHead">${ICONS.doc} Responsible sourcing</div>
            <div class="miniBody">
              <div class="kv">
                <div class="k">Due diligence</div>
                <div class="v">${esc(d.sourcing.dd)}</div>
                <div class="k">Collection / take-back</div>
                <div class="v">${esc(d.sourcing.epr)}</div>
              </div>
            </div>
          </div>
        </div>
      `;
      return;
    }

    if(tab === "circularity"){
      tabBody.innerHTML = `
        <div class="miniCard">
          <div class="miniHead">${ICONS.doc} Circularity</div>
          <div class="miniBody">
            <div class="kv">
              <div class="k">Collection</div>
              <div class="v">${esc(d.sourcing.epr)}</div>
              <div class="k">Disassembly</div>
              <div class="v">Available under restricted access.</div>
              <div class="k">Second life</div>
              <div class="v">Available under authority view.</div>
            </div>
          </div>
        </div>
      `;
      return;
    }

    if(tab === "documents"){
      const list = (d.documents||[]).map(x=>`<li><a href="${esc(x.url)}" target="_blank" rel="noopener">${esc(x.title)}</a></li>`).join("");
      tabBody.innerHTML = `
        <div class="miniCard">
          <div class="miniHead">${ICONS.doc} Documents</div>
          <div class="miniBody">
            <ul style="margin:0; padding-left:18px;">${list || "<li>No public documents</li>"}</ul>
          </div>
        </div>
      `;
      return;
    }

    // access
    const restricted = (role !== "professional" && role !== "authority");
    tabBody.innerHTML = `
      <div class="miniCard">
        <div class="miniHead">${ICONS.doc} Access</div>
        <div class="miniBody">
          ${viewChip()}
          <div style="height:12px"></div>

          <div class="kv">
            <div class="k">Professional</div>
            <div class="v">${restricted ? "Restricted" : esc(d.professional.dismantling)}</div>
            <div class="k">Authority</div>
            <div class="v">${role==="authority" ? `${esc(d.authority.reports.join(" · "))}<br/>${esc(d.authority.soh)}` : "Restricted"}</div>
          </div>

          <div style="height:12px"></div>

          <button class="btn primary" id="goPro2" style="width:100%; justify-content:center;">Open Professional view</button>
          <div style="height:10px"></div>
          <button class="btn" id="goAuth2" style="width:100%; justify-content:center;">Open Authority view</button>
        </div>
      </div>
    `;
    document.getElementById("goPro2").onclick  = ()=> location.href = linkFor({ role:"professional", tab:"access" });
    document.getElementById("goAuth2").onclick = ()=> location.href = linkFor({ role:"authority", tab:"access" });
  }

  function render(){
    if(!data){ renderNotFound(); return; }

    // ✅ İSTEDİĞİN DÜZELTME: "Battery Passport Overview" yerine "DPP-Battery Passport"
    const overview = `
      <div class="card">
        <div class="head">${ICONS.doc} DPP-Battery Passport</div>
        <div class="body">
          <div class="overviewWrap">
            <div class="bigIcon" aria-hidden="true">${ICONS.battery}</div>
            <div class="list">
              <div class="item">
                <span class="k">UID:</span>
                <span class="v inlineLink">
                  <b class="mono">${esc(data.overview.uid)}</b>
                  <span class="iconBtn" id="copyUid" title="Copy UID">${ICONS.clip}</span>
                </span>
              </div>
              <div class="item"><span class="k">Type</span><span class="v">${esc(data.overview.category)}</span></div>
              <div class="item"><span class="k">Manufacturer</span><span class="v">${esc(data.overview.manufacturer)}</span></div>
              <div class="item"><span class="k">Site</span><span class="v">${esc(data.overview.site)}</span></div>
              <div class="item"><span class="k">Production date</span><span class="v">${esc(data.overview.production)}</span></div>
            </div>
          </div>
        </div>
      </div>
    `;

    // ✅ İSTEDİĞİN DÜZELTME: "Safety Snapshot" yerine "Safety"
    const safety = `
      <div class="card">
        <div class="head">${ICONS.shield} Safety</div>
        <div class="body">
          <div style="font-weight:950; color:var(--text); margin-bottom:6px;">Hazardous substances</div>
          <div style="white-space:pre-line;">${esc(data.safety.hazardous)}</div>

          <div style="height:12px"></div>

          <div style="font-weight:950; color:var(--text); margin-bottom:6px;">Extinguishing agent</div>
          <div style="color:var(--teal); font-weight:900;">${esc(data.safety.extinguishing)}</div>
        </div>
      </div>
    `;

    const tabs = `
      <div class="tabsShell">
        <div class="tabs" id="tabs">
          ${tabBtn("Details","details")}
          ${tabBtn("Sustainability","sustainability")}
          ${tabBtn("Circularity","circularity")}
          ${tabBtn("Documents","documents")}
          ${tabBtn("Access","access")}
        </div>
        <div class="tabsBody" id="tabBody"></div>
      </div>
    `;

    app.innerHTML = `
      <div class="grid2">${overview}${safety}</div>
      ${tabs}
    `;

    document.getElementById("tabs").addEventListener("click",(e)=>{
      const t = e.target.closest(".tab");
      if(!t) return;
      location.href = linkFor({ tab: t.dataset.tab });
    });

    document.getElementById("copyUid").onclick = ()=> copy(data.overview.uid);
    showTabBody(document.getElementById("tabBody"));
  }

  render();

  // header buttons
  document.getElementById("copyLink").onclick = ()=> copy(location.href);
  document.getElementById("goAccess").onclick = ()=> location.href = linkFor({ tab:"access", role: (role==="public" ? "professional" : role) });
</script>
</body>
</html>
